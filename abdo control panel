-- ABDO Script GUI (Windows 11 Style Public Control) - Scrollable + Jump Bypass Fixed

local player = game:GetService("Players").LocalPlayer
local userInput = game:GetService("UserInputService")
local runService = game:GetService("RunService")

local gui = Instance.new("ScreenGui")
gui.Name = "AbdoScriptGUI"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = player:WaitForChild("PlayerGui")

-- Main Frame (smaller size)
local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 280, 0, 400)
frame.Position = UDim2.new(0, 30, 0.4, -200)
frame.BackgroundColor3 = Color3.fromRGB(245, 245, 245)
frame.BorderSizePixel = 0
frame.ClipsDescendants = true

-- Drag area at top only
local dragBar = Instance.new("Frame", frame)
dragBar.Size = UDim2.new(1, 0, 0, 36)
dragBar.BackgroundColor3 = Color3.fromRGB(225, 225, 255)
dragBar.BorderSizePixel = 0
dragBar.Name = "DragBar"
dragBar.Active = true

local dragging = false
local dragInput, dragStart, startPos

dragBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

dragBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

userInput.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

-- Title
local title = Instance.new("TextLabel", dragBar)
title.Size = UDim2.new(1, 0, 1, 0)
title.BackgroundTransparency = 1
title.Text = "üî∑ ABDO Control Panel"
title.TextColor3 = Color3.new(0, 0, 0)
title.Font = Enum.Font.GothamBold
title.TextSize = 20

-- ScrollingFrame for buttons
local scrollFrame = Instance.new("ScrollingFrame", frame)
scrollFrame.Size = UDim2.new(1, 0, 1, -36)
scrollFrame.Position = UDim2.new(0, 0, 0, 36)
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.ScrollBarThickness = 6
scrollFrame.BackgroundTransparency = 1

local layout = Instance.new("UIListLayout", scrollFrame)
layout.Padding = UDim.new(0, 6)
layout.SortOrder = Enum.SortOrder.LayoutOrder

layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 10)
end)

-- Button creator
local function createCircleButton(text, callback)
    local btn = Instance.new("TextButton", scrollFrame)
    btn.Size = UDim2.new(1, -20, 0, 34)
    btn.BackgroundColor3 = Color3.fromRGB(230, 230, 255)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(0, 0, 0)
    btn.Font = Enum.Font.GothamSemibold
    btn.TextSize = 14
    btn.BorderSizePixel = 0
    btn.AutoButtonColor = true
    btn.ClipsDescendants = true
    btn.BackgroundTransparency = 0.05
    btn.TextWrapped = true
    btn.TextTruncate = Enum.TextTruncate.AtEnd
    btn.TextScaled = false
    btn.TextXAlignment = Enum.TextXAlignment.Center
    btn.TextYAlignment = Enum.TextYAlignment.Center
    local uiCorner = Instance.new("UICorner")
    uiCorner.CornerRadius = UDim.new(1, 0)
    uiCorner.Parent = btn
    btn.MouseButton1Click:Connect(callback)
    return btn
end

-- Maintain GUI on death
player.CharacterAdded:Connect(function()
    wait(1)
    gui.Parent = player:WaitForChild("PlayerGui")
end)

-- Flying code
local flying = false
createCircleButton("üö© Fly", function()
    flying = not flying
    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if flying and hrp and hum then
        hum.PlatformStand = true
        local bv = Instance.new("BodyVelocity")
        bv.Name = "AbdoFly"
        bv.Velocity = Vector3.zero
        bv.MaxForce = Vector3.new(1e9, 1e9, 1e9)
        bv.Parent = hrp
        local conn
        conn = runService.RenderStepped:Connect(function()
            if not flying or not hrp:FindFirstChild("AbdoFly") then conn:Disconnect() return end
            local moveVec = Vector3.zero
            if userInput:IsKeyDown(Enum.KeyCode.W) then moveVec += workspace.CurrentCamera.CFrame.LookVector end
            if userInput:IsKeyDown(Enum.KeyCode.S) then moveVec -= workspace.CurrentCamera.CFrame.LookVector end
            if userInput:IsKeyDown(Enum.KeyCode.A) then moveVec -= workspace.CurrentCamera.CFrame.RightVector end
            if userInput:IsKeyDown(Enum.KeyCode.D) then moveVec += workspace.CurrentCamera.CFrame.RightVector end
            hrp.AbdoFly.Velocity = moveVec.Magnitude > 0 and moveVec.Unit * 70 or Vector3.zero
        end)
    elseif hrp then
        hum.PlatformStand = false
        if hrp:FindFirstChild("AbdoFly") then
            hrp.AbdoFly:Destroy()
        end
    end
end)

-- Noclip toggle
local noclip = false
createCircleButton("üö™ Noclip", function()
    noclip = not noclip
end)
runService.Stepped:Connect(function()
    if noclip and player.Character then
        for _, part in pairs(player.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- Click TP toggle
local tpEnabled = false
createCircleButton("üë£ Click TP", function()
    tpEnabled = not tpEnabled
end)
local mouse = player:GetMouse()
mouse.Button1Down:Connect(function()
    if tpEnabled and mouse.Target then
        player.Character:MoveTo(mouse.Hit.p)
    end
end)

-- WalkSpeed +
createCircleButton("‚ö° WalkSpeed +", function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.WalkSpeed += 5 end
end)

-- WalkSpeed -
createCircleButton("‚ö° WalkSpeed -", function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.WalkSpeed -= 5 end
end)

-- JumpPower +
createCircleButton("ü¶ò JumpPower +", function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.JumpPower += 5 end
end)

-- JumpPower -
createCircleButton("ü¶ò JumpPower -", function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.JumpPower -= 5 end
end)

-- Reset Walk/Jump
createCircleButton("üîÅ Reset Walk/Jump", function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then
        hum.WalkSpeed = 16
        hum.JumpPower = 50
    end
end)

-- Blood Sky
createCircleButton("ü©∏ Blood Sky", function()
    local sky = game.Lighting:FindFirstChildOfClass("Sky")
    if not sky then
        sky = Instance.new("Sky", game.Lighting)
    end
    local bloodSkyId = "9964681142"
    sky.SkyboxBk = "http://www.roblox.com/asset/?id="..bloodSkyId
    sky.SkyboxDn = "http://www.roblox.com/asset/?id="..bloodSkyId
    sky.SkyboxFt = "http://www.roblox.com/asset/?id="..bloodSkyId
    sky.SkyboxLf = "http://www.roblox.com/asset/?id="..bloodSkyId
    sky.SkyboxRt = "http://www.roblox.com/asset/?id="..bloodSkyId
    sky.SkyboxUp = "http://www.roblox.com/asset/?id="..bloodSkyId
end)

-- Invisible (Client Side)
local invisible = false
createCircleButton("üëª Invisible", function()
    invisible = not invisible
    local character = player.Character
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.LocalTransparencyModifier = invisible and 1 or 0
            elseif part:IsA("Decal") then
                part.Transparency = invisible and 1 or 0
            end
        end
    end
end)

-- Break World (joke & client)
local worldBroken = false
createCircleButton("üí• Break World (Joke & Client)", function()
    worldBroken = not worldBroken
    for _, part in pairs(workspace:GetDescendants()) do
        if part:IsA("BasePart") then
            if worldBroken then
                if not part:GetAttribute("OriginalTransparency") then
                    part:SetAttribute("OriginalTransparency", part.LocalTransparencyModifier or 0)
                end
                part.LocalTransparencyModifier = 1
                part.Velocity = Vector3.new(math.random(-50,50), math.random(10,50), math.random(-50,50))
            else
                if part:GetAttribute("OriginalTransparency") then
                    part.LocalTransparencyModifier = part:GetAttribute("OriginalTransparency")
                else
                    part.LocalTransparencyModifier = 0
                end
            end
        end
    end
end)

-- No Die Mode (regen health)
local noDieEnabled = false
local noDieConn
createCircleButton("üõ°Ô∏è No Die Mode", function()
    noDieEnabled = not noDieEnabled
    local humanoid = player.Character and player.Character:FindFirstChild("Humanoid")
    if noDieEnabled and humanoid then
        if noDieConn then noDieConn:Disconnect() end
        noDieConn = runService.Heartbeat:Connect(function()
            if humanoid and humanoid.Health < humanoid.MaxHealth then
                humanoid.Health = humanoid.MaxHealth
            end
        end)
    else
        if noDieConn then noDieConn:Disconnect() noDieConn = nil end
    end
end)

player.CharacterAdded:Connect(function(char)
    if noDieEnabled then
        local humanoid = char:WaitForChild("Humanoid")
        if noDieConn then noDieConn:Disconnect() end
        noDieConn = runService.Heartbeat:Connect(function()
            if humanoid and humanoid.Health < humanoid.MaxHealth then
                humanoid.Health = humanoid.MaxHealth
            end
        end)
    end
end)

-- Jump Bypass (loops jumping)
local jumpBypassEnabled = false
local jumpLoop

createCircleButton("ü¶ò Jump Bypass", function()
    jumpBypassEnabled = not jumpBypassEnabled
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")

    if jumpBypassEnabled then
        if jumpLoop then
            jumpLoop:Disconnect()
        end
        jumpLoop = runService.Heartbeat:Connect(function()
            if hum and jumpBypassEnabled then
                hum.Jump = true
            else
                if jumpLoop then
                    jumpLoop:Disconnect()
                    jumpLoop = nil
                end
            end
        end)
    else
        if jumpLoop then
            jumpLoop:Disconnect()
            jumpLoop = nil
        end
    end
end)

player.CharacterAdded:Connect(function(char)
    wait(1)
    if jumpBypassEnabled then
        local hum = char:WaitForChild("Humanoid")
        if jumpLoop then jumpLoop:Disconnect() end
        jumpLoop = runService.Heartbeat:Connect(function()
            if hum and jumpBypassEnabled then
                hum.Jump = true
            else
                if jumpLoop then
                    jumpLoop:Disconnect()
                    jumpLoop = nil
                end
            end
        end)
    end
end)

-- Close GUI and full reset
createCircleButton("‚ùå Close & Exit", function()
    gui:Destroy()
    -- You can add additional cleanup if your executor supports it
end)

--// ✅ ABDO Script GUI (Windows 11 Style Public Control) - XENO Optimized

local player = game:GetService("Players").LocalPlayer
local userInput = game:GetService("UserInputService")
local gui = Instance.new("ScreenGui")
gui.Name = "AbdoScriptGUI"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 280, 0, 520)
frame.Position = UDim2.new(0, 30, 0, 150) -- Changed to top-left origin with some offset
frame.BackgroundColor3 = Color3.fromRGB(245, 245, 245)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = false -- We'll handle custom dragging
frame.AnchorPoint = Vector2.new(0, 0) -- Fixed anchor point to top-left
frame.BackgroundTransparency = 0.05
frame.ClipsDescendants = true

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 36)
title.BackgroundColor3 = Color3.fromRGB(225, 225, 255)
title.Text = "🔷 ABDO Control Panel"
title.TextColor3 = Color3.new(0, 0, 0)
title.Font = Enum.Font.GothamBold
title.TextSize = 20

-- Custom dragging support
local dragging = false
local dragInput, mousePos, framePos

title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        mousePos = input.Position
        framePos = frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

title.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - mousePos
        frame.Position = UDim2.new(
            framePos.X.Scale,
            framePos.X.Offset + delta.X,
            framePos.Y.Scale,
            framePos.Y.Offset + delta.Y
        )
    end
end)

-- Button creator
local function createCircleButton(text, order, callback)
    local btn = Instance.new("TextButton", frame)
    btn.Size = UDim2.new(1, -20, 0, 34)
    btn.Position = UDim2.new(0, 10, 0, 40 + (order * 38))
    btn.BackgroundColor3 = Color3.fromRGB(230, 230, 255)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(0, 0, 0)
    btn.Font = Enum.Font.GothamSemibold
    btn.TextSize = 14
    btn.BorderSizePixel = 0
    btn.AutoButtonColor = true
    btn.ClipsDescendants = true
    btn.AnchorPoint = Vector2.new(0, 0)
    btn.ZIndex = 2
    btn.BackgroundTransparency = 0.05
    btn.TextWrapped = true
    btn.TextTruncate = Enum.TextTruncate.AtEnd
    btn.TextScaled = false
    btn.TextXAlignment = Enum.TextXAlignment.Center
    btn.TextYAlignment = Enum.TextYAlignment.Center
    local uiCorner = Instance.new("UICorner")
    uiCorner.CornerRadius = UDim.new(1, 0)
    uiCorner.Parent = btn
    btn.MouseButton1Click:Connect(callback)
    return btn
end

-- Maintain GUI on death
player.CharacterAdded:Connect(function()
    wait(1)
    gui.Parent = player:WaitForChild("PlayerGui")
end)

-- 🛡️ God Mode toggle (removed as you requested, so skipping)

-- 🚩 Fly (works on Xeno and Delta, no auto disable on Delta)
local flying = false
local flyConn

createCircleButton("🚩 Fly", 0, function()
    flying = not flying
    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if flying and hrp and hum then
        hum.PlatformStand = true
        local bv = hrp:FindFirstChild("AbdoFly") or Instance.new("BodyVelocity")
        bv.Name = "AbdoFly"
        bv.Velocity = Vector3.new(0,0,0)
        bv.MaxForce = Vector3.new(1e9,1e9,1e9)
        bv.Parent = hrp

        if flyConn then flyConn:Disconnect() end
        flyConn = game:GetService("RunService").RenderStepped:Connect(function()
            if not flying or not hrp:FindFirstChild("AbdoFly") then
                flyConn:Disconnect()
                flyConn = nil
                return
            end
            local moveVec = Vector3.zero
            if userInput:IsKeyDown(Enum.KeyCode.W) then moveVec += workspace.CurrentCamera.CFrame.LookVector end
            if userInput:IsKeyDown(Enum.KeyCode.S) then moveVec -= workspace.CurrentCamera.CFrame.LookVector end
            if userInput:IsKeyDown(Enum.KeyCode.A) then moveVec -= workspace.CurrentCamera.CFrame.RightVector end
            if userInput:IsKeyDown(Enum.KeyCode.D) then moveVec += workspace.CurrentCamera.CFrame.RightVector end
            bv.Velocity = moveVec.Magnitude > 0 and moveVec.Unit * 70 or Vector3.zero
        end)
    elseif hrp then
        if flyConn then
            flyConn:Disconnect()
            flyConn = nil
        end
        hum.PlatformStand = false
        if hrp:FindFirstChild("AbdoFly") then
            hrp.AbdoFly:Destroy()
        end
    end
end)

-- 🚪 Toggle Noclip
local noclip = false
createCircleButton("🚪 Noclip", 1, function()
    noclip = not noclip
end)
game:GetService("RunService").Stepped:Connect(function()
    if noclip and player.Character then
        for _, part in pairs(player.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- 👣 Toggle Click TP
local tpEnabled = false
createCircleButton("👣 Click TP", 2, function()
    tpEnabled = not tpEnabled
end)
local mouse = player:GetMouse()
mouse.Button1Down:Connect(function()
    if tpEnabled and mouse.Target then
        player.Character:MoveTo(mouse.Hit.p)
    end
end)

-- ⚡ WalkSpeed +
createCircleButton("⚡ WalkSpeed +", 3, function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.WalkSpeed += 5 end
end)

-- ⚡ WalkSpeed -
createCircleButton("⚡ WalkSpeed -", 4, function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.WalkSpeed -= 5 end
end)

-- 🫘 JumpPower +
createCircleButton("🫘 JumpPower +", 5, function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.JumpPower += 5 end
end)

-- 🫘 JumpPower -
createCircleButton("🫘 JumpPower -", 6, function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.JumpPower -= 5 end
end)

-- 🔁 Reset Walk/Jump
createCircleButton("🔁 Reset Walk/Jump", 7, function()
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then
        hum.WalkSpeed = 16
        hum.JumpPower = 50
    end
end)

-- 👻 Invisible (client side only)
local invisible = false
createCircleButton("👻 Invisible", 8, function()
    invisible = not invisible
    local character = player.Character
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Transparency = invisible and 1 or 0
            elseif part:IsA("Decal") then
                part.Transparency = invisible and 1 or 0
            end
        end
    end
end)

-- 💥 Break World (Joke & Client Side)
local worldBroken = false
createCircleButton("💥 Break World (Joke & Client)", 9, function()
    local character = player.Character
    if not character then return end
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    worldBroken = not worldBroken

    if worldBroken then
        -- Hide nearby parts locally within 100 studs
        for _, part in pairs(workspace:GetDescendants()) do
            if part:IsA("BasePart") and (part.Position - hrp.Position).Magnitude < 100 then
                if not part:GetAttribute("OriginalTransparency") then
                    part:SetAttribute("OriginalTransparency", part.Transparency)
                end
                part.LocalTransparencyModifier = 1
            end
        end
    else
        -- Restore local transparency
        for _, part in pairs(workspace:GetDescendants()) do
            if part:IsA("BasePart") and part:GetAttribute("OriginalTransparency") then
                part.LocalTransparencyModifier = 0
            end
        end
    end
end)

-- 🔴 Blood Sky toggle
local bloodSkyOn = false
createCircleButton("🌌 Blood Sky", 10, function()
    bloodSkyOn = not bloodSkyOn
    if bloodSkyOn then
        local sky = Instance.new("Sky")
        sky.Name = "AbdoBloodSky"
        sky.SkyboxBk = "rbxassetid://504470299"
        sky.SkyboxDn = "rbxassetid://504470297"
        sky.SkyboxFt = "rbxassetid://504470301"
        sky.SkyboxLf = "rbxassetid://504470298"
        sky.SkyboxRt = "rbxassetid://504470300"
        sky.SkyboxUp = "rbxassetid://504470296"
        sky.Parent = game.Lighting
    else
        local oldSky = game.Lighting:FindFirstChild("AbdoBloodSky")
        if oldSky then oldSky:Destroy() end
    end
end)

-- 🦘 Jump Bypass (hold space to continuously jump)
local jumpBypassOn = false
local jumpConnection
createCircleButton("🦘 Jump Bypass", 11, function()
    jumpBypassOn = not jumpBypassOn
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if jumpBypassOn and hum then
        jumpConnection = game:GetService("RunService").Stepped:Connect(function()
            if userInput:IsKeyDown(Enum.KeyCode.Space) then
                hum.Jump = true
            end
        end)
    else
        if jumpConnection then
            jumpConnection:Disconnect()
            jumpConnection = nil
        end
    end
end)

-- ❌ Close fully (closes the entire script)
createCircleButton("❌ Close Full", 12, function()
    gui:Destroy()
    if flyConn then flyConn:Disconnect() end
    if jumpConnection then jumpConnection:Disconnect() end
    -- Disconnect other persistent connections if you added any
end)
